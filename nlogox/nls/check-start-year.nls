; extensions [string]
; globals [start-year]

to-report test-start-year
  if (is-string? start-year) [
    set start-year read-from-string start-year
  ]
  
  ifelse (
    (string:rex-match? "^[0-9]{4}.*" (word start-year)) and
    (start-year >= 1951) and 
    (start-year <= 2024)
  ) [
    report true
  ] [
    report false
  ]
end

to-report check-start-year
  ifelse (test-start-year) [
    report true
  ] [   
    (ifelse (not string:rex-match? "^[0-9]{4}.*" (word start-year)) [
      report "The year must have 4 digits."
    ] [
      report (word
        "The year for the 'Historical Monthly Weather Data' "
        "series must be between "
        "1951 and 2024."
      )
    ])
  ]
end

to assert-start-year
  if (not test-start-year) [
    user-message check-start-year
  ]
end
